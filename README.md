# Indonesia COVID API

This is a RESTful API server created in Python with FastAPI framework that serves informations about current status of COVID-19 cases and vaccination rates in Indonesia.

Data source used in this API: Indonesian Government COVID-19 Data API (https://data.covid19.go.id/public/api)

Python version: 3.8+

## How to run

1. Install the dependencies
    ```
    pip install -r requirements.txt
    ```
2. Run the server
    ```
    uvicorn app.main:app --host <HOST_IP> --port <HOST_PORT>
    ```

## Use Docker image

A Docker image is also available to use. To grab the image from Docker Hub and run it, use the command:

```
docker run -d -p <HOST_PORT>:80 hifra/indonesia-covid-api
```

## Testing

All the test scripts are available in the `tests` folder. To run the test use:
```
pytest
```

## Usage

All the available API path/endpoints are listed below. You can also check the documentation generated by FastAPI by accessing `http://<HOST_IP>:<HOST_PORT>/docs`.

### GET `/`

Returns total and newest update on COVID-19 cases and vaccination rate.

**Output example**:
```json
{
    "ok": true,
    "message": "Data fetched successfully",
    "data":{
        "total_positive": 4263168,
        "total_recovered": 4114689,
        "total_deaths": 144097,
        "total_active": 4382,
        "new_positive": 174,
        "new_recovered": 190,
        "new_deaths": 1,
        "new_active": -17,
        "total_vaccinated_1": 165900887,
        "total_vaccinated_2": 114103362,
        "new_vaccinated_1": 4039665,
        "new_vaccinated_2": 72924
    }
}
```

### GET `/yearly`

Returns yearly total data on COVID-19 cases (and vaccination rate **if exists**).

Parameter:

- `since`: \<`year`>

    parameter to control since when (year) the data will be returned, by default since the year the first cases detected. **example**: `?since=2020`

- `upto`: \<`year`>

    parameter to control up to when (year) the data will be returned, by default up to the current year. **example**: `?upto=2022`

**Output example**:
```json
{
    "ok": true,
    "message": "Data fetched successfully",
    "data": [
        ...,
        {
            "year": "2021",
            "positive": 3519522,
            "recovered": 3503237,
            "deaths": 121956,
            "active": 584118,
            "vaccinated_1": 161082857,
            "vaccinated_2": 113666327
        }
        ...,
    ]
}
```

### GET `/yearly/{year}`

Returns yearly total data on COVID-19 cases (and vaccination rate **if exists**) in the year provided in `{year}`.

**Output example**:
```json
{
    "ok": true,
    "message": "Data fetched successfully",
    "data": {
        "year": "2021",
        "positive": 3519522,
        "recovered": 3503237,
        "deaths": 121956,
        "active": 584118,
        "vaccinated_1": 161082857,
        "vaccinated_2": 113666327
    }

}
```

### GET `/monthly`

Returns monthly total data on COVID-19 cases (and vaccination rate **if exists**).

Parameter:

- `since`: \<`year`>.\<`month`>

    parameter to control since when (year, month) the data will be returned, by default since the month the first cases detected. **example**: `?since=2020.03`

- `upto`: \<`year`>.\<`month`>

    parameter to control up to when (year, month) the data will be returned, by default up to the current month. **example**: `?upto=2022.01`

**Output example**:
```json
{
    "ok": true,
    "message": "Data fetched successfully",
    "data": [
        ...,
        {
            "month": "2021-03",
            "positive": 177078,
            "recovered": 205627,
            "deaths": 4692,
            "active": 3431,
            "vaccinated_1": 8095717,
            "vaccinated_2": 3709597
        }
        ...,
    ]
}
```

### GET `/monthly/{year}`

Returns monthly total data on COVID-19 cases (and vaccination rate **if exists**) in the year provided in `{year}`.

Parameter:

- `since`: \<`year`>.\<`month`>

    parameter to control since when (year, month) the data will be returned, by default since the first month of the year. **example**: `?since=2021.01`

- `upto`: \<`year`>.\<`month`>

    parameter to control up to when (year, month) the data will be returned, by default up to the last month of the year. **example**: `?upto=2021.12`

**Output example**:
```json
{
    "ok": true,
    "message": "Data fetched successfully",
    "data": [
        {
            "month": "2021-01",
            "positive": 335116,
            "recovered": 262124,
            "deaths": 7860,
            "active": 67992
        }
        ...,
        {
            "month":"2021-12",
            "positive":6311,
            "recovered":9677,
            "deaths":264,
            "active":311,
            "vaccinated_1":21717419,
            "vaccinated_2":18192459
        }
    ]
}
```

### GET `/monthly/{year}/{month}`

Returns monthly total data on COVID-19 cases (and vaccination rate **if exists**) in the year and month provided in `{year}` and `{month}`.

**Output example**:
```json
{
    "ok": true,
    "message": "Data fetched successfully",
    "data": {
        "month": "2021-12",
        "positive": 6311,
        "recovered": 9677,
        "deaths": 264,
        "active": 311,
        "vaccinated_1": 21717419,
        "vaccinated_2": 18192459
    }

}
```

### GET `/daily`

Returns daily data on COVID-19 cases (and vaccination rate **if exists**).

Parameter:

- `since`: \<`year`>.\<`month`>.\<`day`>

    parameter to control since when (year, month, date) the data will be returned, by default since the day the first cases detected. **example**: `?since=2020.03.02`

- `upto`: \<`year`>.\<`month`>.\<`day`>

    parameter to control up to when (year, month, date) the data will be returned, by default up to the latest day. **example**: `?upto=2022.01.01`

**Output example**:
```json
{
    "ok": true,
    "message": "Data fetched successfully",
    "data": [
        ...,
        {
            "date": "2022-01-02",
            "positive": 174,
            "recovered": 190,
            "deaths": 1,
            "active": -17,
            "vaccinated_1": 4039665,
            "vaccinated_2": 72924
        }
        ...,
    ]
}
```

### GET `/daily/{year}`

Returns daily data on COVID-19 cases (and vaccination rate **if exists**) in the year provided in `{year}`.

Parameter:

- `since`: \<`year`>.\<`month`>.\<`day`>

    parameter to control since when (year, month, date) the data will be returned, by default since the first day of the year. **example**: `?since=2021.01.01`

- `upto`: \<`year`>.\<`month`>.\<`day`>

    parameter to control up to when (year, month, date) the data will be returned, by default up to the last day of the year. **example**: `?upto=2022.12.31`

**Output example**:
```json
{
    "ok": true,
    "message": "Data fetched successfully",
    "data": [
        {
            "date": "2021-01-01",
            "positive": 8072,
            "recovered": 6839,
            "deaths": 191,
            "active": 1042
        }
        ...,
        {
            "date": "2021-12-31",
            "positive" :180,
            "recovered": 193,
            "deaths": 6,
            "active": -19,
            "vaccinated_1": 1070414,
            "vaccinated_2": 661959
        }
    ]
}
```

### GET `/daily/{year}/{month}`

Returns daily data on COVID-19 cases (and vaccination rate **if exists**) in the year and month provided in `{year}` and `{month}`.

Parameter:

- `since`: \<`year`>.\<`month`>.\<`day`>

    parameter to control since when (year, month, date) the data will be returned, by default since the first day of the month. **example**: `?since=2021.01.01`

- `upto`: \<`year`>.\<`month`>.\<`day`>

    parameter to control up to when (year, month, date) the data will be returned, by default up to the last day of the month. **example**: `?upto=2021.01.31`

**Output example**:
```json
{
    "ok": true,
    "message": "Data fetched successfully",
    "data": [
        {
            "date":"2021-05-01",
            "positive":4512,
            "recovered":4344,
            "deaths":131,
            "active":37,
            "vaccinated_1":57377,
            "vaccinated_2":37724
        }
        ...,
        {
            "date": "2021-05-31",
            "positive": 5662,
            "recovered": 5121,
            "deaths": 174,
            "active": 367,
            "vaccinated_1": 108972,
            "vaccinated_2": 47346
        }
    ]
}
```

### GET `/daily/{year}/{month}/{day}`

Returns daily data on COVID-19 cases (and vaccination rate **if exists**) on the day provided in `{year}`, `{month}`, and `{day}`.

**Output example**:
```json
{
    "ok": true,
    "message": "Data fetched successfully",
    "data": {
        "date": "2021-12-31",
        "positive": 180,
        "recovered": 193,
        "deaths": 6,
        "active": -19,
        "vaccinated_1": 1070414,
        "vaccinated_2": 661959
    }

}
```
